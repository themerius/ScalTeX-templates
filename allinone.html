<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>ScalTex Templating</title>
<link rel="stylesheet" href="css/reset.css" />
<link rel="stylesheet" href="css/typo.css" />
<link rel="stylesheet" href="css/grid.css" />
<script src="https://raw.github.com/janl/mustache.js/master/mustache.js"></script>
<script src="scaltex/src/scaltex.js"></script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>

<div id="constructionArea"></div>
<div id="viewArea"></div>

<script id="page" type="text/template">
<div class="pageA4">
  <div class="layoutGrid">
    {{{content}}}
  </div>
  {{{footer}}}
</div>
</script>

<script id="pagina" type="text/template">
<div id="obj_{{objId}}" class="layoutGridBottom pagina">
  <div class="row line">
    <div class="col3">
      <p>{{institutName}}</p>
    </div>
    <div class="col1 right">
     <p>{{pageNr}}</p>
    </div>
    <div class="row-end">&nbsp;</div>
</div>
</script>

<script id="text_3column" type="text/template">
<div id="obj_{{objId}}" class="row">
  <div class="col3">
    <p>{{{text}}}</p>
    {{#newline}}
    </br>
    {{/newline}}
  </div>
  <div class="row-end">&nbsp;</div>
</div>
</script>

<script id="heading" type="text/template">
<div id="obj_{{objId}}" class="row">
  <div class="col4"><{{h}}>{{number}}</br>{{heading}}</{{h}}></br></br></div>
  <div class="row-end">&nbsp;</div>
</div>
</script>

<script id="figure_2column_left" type="text/template">
<div id="obj_{{objId}}" class="row topSpace bottomSpace">
  <div class="col2">
    <img class="scaling" src="{{src}}" alt="{{description}}" />
  </div>
  <div class="col1">  <!-- style="margin-top: parentHight - self.hight px" -->
    <strong>Abbildung {{number}}: {{{description}}}</strong>
  </div>
  <div class="row-end">&nbsp;</div>
</div>
</script>

<!--
     BEGIN
     =====
-->

<script>
var section_1 = {  // TODO: define kind of object or determine! 
  heading: "First Heading",
  number: 1,
  h: "h1",
  objId: 0
};

var par_1 = {
  text: "Lorem $ipsum^2$ dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.",
  newline: [true, true],
  objId: 1
};

var subsection_1_1 = {
  heading: "Subheading",
  number: 1.1,
  h: "h2",
  objId: 2
};

var par_2 = {
  text: "Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.",
  objId: 3
};

var figData = {
    src: "https://raw.github.com/themerius/ScalTeX/play/public/images/plot.png",
    number: 1,
    description: "Blindtext Bildunterschrift Marginaltext in Marginalspalte </br> Als es die ersten HuÌˆgel des Kursivgebirges",
  objId: 4
};

var par_3 = {
  text: "Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.",
  objId: 5
};

var section_2 = {
  heading: "Second Heading",
  number: 2,
  h: "h1",
  objId: 6
};

var subsection_2_1 = {
  heading: "Subheading",
  number: 2.1,
  h: "h2",
  objId: 7
};

var par_4 = {
  text: "Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.",
  newline: true,
  objId: 8
};

var par_5 = {
  text: "Look at the inline math like $X=\\mathcal F(x):\\mathbb R\\to\\mathbb C$. Or full math: $$x(t)=\\frac1{\\sqrt{2\\pi}}\\int_{-2\\pi F}^{2\\pi F} X(\\omega)e^{\\mathrm{i}\\omega\\,t}\, d\\omega$$",
  objId: 9,
  newline: true
};


var par_6 = {
  text: "Lorem <em>ipsum dolor</em> sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.",
  objId: 10
};


var json_from_generator = [
  {type: "NewPage", context: "ContinuousPages"},
  {type: "heading", context: section_1},
  {type: "text", context: par_1},
  {type: "heading", context: subsection_1_1},
  {type: "text", context: par_2},
  {type: "figure", context: figData},
  {type: "text", context: par_3},
  {type: "NewPage", context: "ContinuousPages"},
  {type: "heading", context: section_2},
  {type: "heading", context: subsection_2_1},
  {type: "text", context: par_4},
  {type: "text", context: par_5},
  {type: "text", context: par_6}
];

var footer = new scaltex.Object("pagina");
footer.predefinedJson = {
  institutName: "Fraunhofer SCAI",
  pageNr: new scaltex.PageCount("arabic"),
  objId: -1
};

var page = new scaltex.Object("page");
page.predefinedJson = {
  content: new scaltex.PageContent(),
  footer: footer,
  objId: -1
};

var config = new scaltex.Configuration(contentHeight=241.3);
config.templateObjects.text = new scaltex.Object("text_3column");
config.templateObjects.heading = new scaltex.Object("heading");
config.templateObjects.figure = new scaltex.Object("figure_2column_left");
config.pageObjects.ContinuousPages = new scaltex.ContinuousPages(
    page, config, ["pageA4", "layoutGrid"]);

MathJax.Hub.Config({
  tex2jax: {inlineMath: [ ['$','$'], ["\\(","\\)"] ]}
});

var builder = new scaltex.DocumentBuilder(json_from_generator, config, "constructionArea", "viewArea");
builder.render();

window.onload = function () {
  builder.splitIntoPages();
};
</script>

</body>
